<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Your Birthday Surprise üéÅ</title>
  <link rel="stylesheet" href="style.css">

  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #333;
      padding: 20px;
    }

    .surprise-wrap {
      max-width: 1000px;
      width: 100%;
    }

    h1 {
      font-family: 'Dancing Script', cursive;
      font-size: 2.6rem;
      margin-bottom: 8px;
      color: #ff4b91;
    }

    p.lead {
      margin-bottom: 20px;
      color: #555;
    }

    #collageImage {
      max-width: 95%;
      max-height: 70vh;
      width: auto;
      height: auto;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.18);
      display: block;
      margin: 0 auto 24px;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 500ms ease, transform 500ms ease;
    }
    #collageImage.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .download-btn {
      background: #ff4081;
      color: white;
      border: none;
      font-size: 1.05rem;
      font-weight: 600;
      padding: 14px 36px;
      border-radius: 40px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(255,64,129,0.35);
      transition: transform .12s ease, background .12s ease;
      margin-bottom: 8px;
    }
    .download-btn:active { transform: scale(.98); }
    .download-btn:hover { background: #e73371; }

    #downloadNote {
      margin-top: 10px;
      font-size: 0.95rem;
      color: #444;
      min-height: 1.2em;
      opacity: 0.95;
    }
  </style>
</head>
<body>
  <div class="surprise-wrap">
    <h1>üíê Your Birthday Surprise üíê</h1>
    <p class="lead">Here‚Äôs something made just for you ‚Äî click download to save it üíñ</p>

    <img id="collageImage" src="photos/image7.png" alt="Birthday Collage">

    <div>
      <button id="downloadCollageBtn" class="download-btn">üì∏ Download Your Collage</button>
    </div>

    <div id="downloadNote" aria-live="polite"></div>
  </div>

  <!-- Confetti library -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    (function () {
      const img = document.getElementById('collageImage');
      const downloadBtn = document.getElementById('downloadCollageBtn');
      const downloadNote = document.getElementById('downloadNote');

      // üéâ Confetti celebration sequence
      function celebration() {
        confetti({ particleCount: 120, spread: 140, origin: { y: 0.35 } });
        setTimeout(() => confetti({ particleCount: 60, spread: 160, origin: { x: 0.2, y: 0.2 } }), 300);
        setTimeout(() => confetti({ particleCount: 60, spread: 160, origin: { x: 0.8, y: 0.2 } }), 600);
        let end = Date.now() + 1200;
        const interval = setInterval(function() {
          if (Date.now() > end) return clearInterval(interval);
          confetti({
            particleCount: 10,
            startVelocity: 20,
            spread: 60,
            origin: { x: Math.random(), y: 0.0 }
          });
        }, 200);
      }

      // Reveal image with animation and confetti
      function onImageReady() {
        img.classList.add('visible');
        setTimeout(celebration, 350);
      }

      // If already loaded, or wait for it
      if (img.complete && img.naturalWidth !== 0) {
        onImageReady();
      } else {
        img.addEventListener('load', onImageReady);
        img.addEventListener('error', function () {
          img.classList.add('visible');
          setTimeout(() => {
            confetti({ particleCount: 40, spread: 100, origin: { y: 0.4 } });
          }, 250);
          downloadNote.textContent = 'Image failed to load ‚Äî try refreshing or check file path.';
        });
      }

      // üì• Download and redirect
      downloadBtn.addEventListener("click", function() {
        const url = img.src;
        const a = document.createElement("a");
        a.href = url;
        a.download = "Your-Birthday-Collage.jpg";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        // Small confetti burst
        confetti({ particleCount: 80, spread: 120, origin: { y: 0.4 } });
        downloadNote.textContent = "Download started, hope you love it! üíï";

        // Wait so she sees confetti, then go to thankyou.html
        setTimeout(() => {
          window.location.href = "thankyou.html";
        }, 500); // 2.5 seconds delay
      });
    })();
  </script>
</body>
</html>
